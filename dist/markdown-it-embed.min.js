/*! @maxx5/markdown-it-embed 1.0.0 https://github.com/ma-x-x/markdown-it-embed @license ISC */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).markdownitIns=t()}(this,(function(){"use strict";const e=["aac","m4a","mp3","oga","ogg","wav"],t=["mp4","m4v","ogv","webm","mpg","mpeg"],i=Object.keys({".html":"text/html",".xml":"text/xml",".text":"text/plain",".pdf":"application/pdf",".word":"application/msword",".doc":"application/msword",".wp":"application/wordperfect",".au":"audio/x-au",".mid":"x-music/x-midi",".midi":"x-music/x-midi",".ra":"audio/x-realaudio",".ram":"audio/x-pn-realaudio",".gz":"application/x-gzip",".gzip":"multipart/x-gzip",".tar":"application/x-tar",".zip":"multipart/x-zip",".rtf":"text/richtext"});let r={en:{"html5 video not supported":"Your browser does not support playing HTML5 video.","html5 audio not supported":"Your browser does not support playing HTML5 audio.","html5 media fallback link":'You can <a href="%s" download>download the file</a> instead.',"html5 media description":"Here is a description of the content: %s"}},o=function(e,t,i){if(r[e]&&r[e][t]||(e="en"),!r[e])return"";let o=r[e][t]||"";if(i)for(let e of i)o=o.replace("%s",e);return o};function s(r,o){const s=r.match(/\.([^/.]+)$/);if(null===s)return"image";const a=s[1];return-1!=e.indexOf(a.toLowerCase())?"audio":-1!=t.indexOf(a.toLowerCase())?"video":-1!=o.indexOf(a.toLowerCase())&&-1!=i.includes(a.toLowerCase())?"embed":"image"}return{html5Media:function(e,t={}){t.messages&&(r=t.messages),t.translateFn&&(o=t.translateFn);const i=void 0!==t.videoAttrs?t.videoAttrs:'controls class="html5-video-player"',a=void 0!==t.audioAttrs?t.audioAttrs:'controls class="html5-audio-player"',n=t.embedExtensions||["pdf"];let l={url:"",ext:""};e.inline.ruler.at("image",((t,i)=>function(e,t,i,r,o){let a,n,l,d,p,c,u,m,f,h,x,g,v,w="",A=e.pos,b=e.posMax;if(33!==e.src.charCodeAt(e.pos)||91!==e.src.charCodeAt(e.pos+1))return!1;if(c=e.pos+2,p=e.md.helpers.parseLinkLabel(e,e.pos+1,!1),p<0)return!1;if(u=p+1,u<b&&40===e.src.charCodeAt(u)){for(u++;u<b&&(n=e.src.charCodeAt(u),i.utils.isSpace(n)||10===n);u++);if(u>=b)return!1;for(v=u,f=e.md.helpers.parseLinkDestination(e.src,u,e.posMax),f.ok&&(w=e.md.normalizeLink(f.str),e.md.validateLink(w)?u=f.pos:w=""),v=u;u<b&&(n=e.src.charCodeAt(u),i.utils.isSpace(n)||10===n);u++);if(f=e.md.helpers.parseLinkTitle(e.src,u,e.posMax),u<b&&v!==u&&f.ok)for(h=f.str,u=f.pos;u<b&&(n=e.src.charCodeAt(u),i.utils.isSpace(n)||10===n);u++);else h="";if(u>=b||41!==e.src.charCodeAt(u))return e.pos=A,!1;u++}else{if(void 0===e.env.references)return!1;if(u<b&&91===e.src.charCodeAt(u)?(v=u+1,u=e.md.helpers.parseLinkLabel(e,u),u>=0?d=e.src.slice(v,u++):u=p+1):u=p+1,d||(d=e.src.slice(c,p)),m=e.env.references[i.utils.normalizeReference(d)],!m)return e.pos=A,!1;w=m.href,h=m.title}if(e.pos=u,e.posMax=b,t)return!0;l=e.src.slice(c,p),e.md.inline.parse(l,e.md,e.env,g=[]);const k=url.match(/\.([^/.]+)$/);if(null===k)return"image";const L=k[1];o.url=w,o.ext=L;const y=s(w,r),$="image"==y?"img":y;return x=e.push(y,$,0),x.attrs=a=[["src",w]],"image"==y&&a.push(["alt",""]),x.children=g,x.content=l,h&&a.push(["title",h]),e.pos=u,e.posMax=b,!0}(t,i,e,n,l))),e.renderer.rules.video=e.renderer.rules.audio=(t,r,s,n)=>(s.html5Media={videoAttrs:i,audioAttrs:a},function(e,t,i,r,s,a){const n=e[t],l=n.type;if("video"!==l&&"audio"!==l)return"";let d=i.html5Media[`${l}Attrs`].trim();d&&(d=" "+d);const p=n.attrs[n.attrIndex("src")][1],c=-1!=n.attrIndex("title")?` title="${s.utils.escapeHtml(n.attrs[n.attrIndex("title")][1])}"`:"",u=o(r.language,`html5 ${l} not supported`)+"\n"+o(r.language,"html5 media fallback link",[p]),m=n.content?"\n"+o(r.language,"html5 media description",[s.utils.escapeHtml(n.content)]):"";return`<${l} src="${p}"${c}${d} type="${subtypeMap[a]}">\n${u}${m}\n</${l}>`}(t,r,s,n,e,l))},messages:r,guessMediaType:s}}));
